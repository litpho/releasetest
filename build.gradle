import org.ajoberstar.gradle.git.release.semver.RebuildVersionStrategy
import org.ajoberstar.gradle.git.release.opinion.Strategies

buildscript {
  repositories {
    mavenLocal()
    jcenter()
    mavenCentral()
  }
  dependencies {
    classpath 'org.ajoberstar:gradle-git:1.7.1-dev.1.uncommitted+fe8d229'
  }
}

apply plugin: 'org.ajoberstar.grgit'
apply plugin: 'org.ajoberstar.release-base'

release {
    versionStrategy RebuildVersionStrategy.INSTANCE
    versionStrategy Strategies.SNAPSHOT
    versionStrategy Strategies.PRE_RELEASE
    versionStrategy Strategies.FINAL
    defaultVersionStrategy = Strategies.SNAPSHOT
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'maven-publish'

    sourceCompatibility = 1.8

    dependencies {
        compile 'org.slf4j:slf4j-api:1.7.21'
    }

    rootProject.tasks.release.dependsOn build
    rootProject.tasks.release.dependsOn publish

    publishing {
        repositories {
            maven {
                url 'file://d:/temp/nexus'
            }
        }

        publications {
            mavenJava(MavenPublication) {
                from components.java
            }
        }
    }
}

project(':b') {
    dependencies {
        compile project(':a')
    }
}
